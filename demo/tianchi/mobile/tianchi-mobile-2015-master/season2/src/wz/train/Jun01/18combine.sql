drop table if exists interval2day_combine18;
create table interval2day_combine18 as
select t1.user_id,t1.item_id,

t1.item_category,
ui_bws_cnt,
--ui_clt_cnt,ui_crt_cnt,
ui_buy_cnt,
ui_beh_cnt,ui_beh_wgt,ui_beh_wgt_pow,
ui_max_bws_hr,
ui_max_clt_hr,
ui_max_crt_hr,
ui_max_buy_hr,
ui_max_beh_hr,
--ui_min_bws_hr,ui_min_clt_hr,ui_min_crt_hr,ui_min_buy_hr,
ui_min_beh_hr,
ui_bws_span,ui_beh_span,

--uc_bws_cnt,uc_clt_cnt,uc_crt_cnt,uc_buy_cnt,
--uc_beh_cnt,uc_beh_wgt,uc_beh_wgt_pow,
uc_max_bws_hr,uc_max_clt_hr,uc_max_crt_hr,uc_max_buy_hr,uc_max_beh_hr,
--uc_min_bws_hr,uc_min_clt_hr,uc_min_crt_hr,uc_min_buy_hr,
uc_min_beh_hr,
uc_bws_span,uc_beh_span,
t1.label,
pre1_ui_bws_cnt,
pre1_ui_clt_cnt,
pre1_ui_crt_cnt,
pre1_ui_buy_cnt,
pre1_ui_beh_cnt,
pre1_ui_beh_wgt,
pre1_ui_beh_wgt_pow,
pre1_ui_max_bws_hr,
pre1_ui_max_clt_hr,
pre1_ui_max_crt_hr,
pre1_ui_max_buy_hr,
pre1_ui_max_beh_hr,
--pre1_ui_min_bws_hr,pre1_ui_min_clt_hr,pre1_ui_min_crt_hr,pre1_ui_min_buy_hr,
pre1_ui_min_beh_hr,
pre1_ui_bws_span,pre1_ui_beh_span,

hour00,hour01,hour02,hour03,hour04,hour05,hour06,hour07,hour08,hour09,hour10,hour11,hour12,hour13,hour14,hour15,hour16,hour17,hour18,hour19,hour20,hour21,hour22,hour23,
--last_collect_hour,last_cart_hour,last_browse_time_span,last_browse_times,last_operate_weight_times,last_operate_time,
--last_2_click_times,last_2_operate_times,last_2_collect_hour,last_2_cart_hour,last_2_browse_time_span,
pro1_user_beh4,pro1_user_beh3,pro1_user_beh2,pro1_user_beh1,pro2_user_beh4,pro2_user_beh3,pro2_user_beh2,pro2_user_beh1,pro3_user_beh4,
pro3_user_beh3,pro3_user_beh2,pro3_user_beh1,udiff1,udiff2,udiff3,uavghour1,uavghour2,uavghour3,upro1_bws_to_buy,upro1_col_to_buy,
upro1_crt_to_buy,upro2_bws_to_buy,upro2_col_to_buy,upro2_crt_to_buy,upro3_bws_to_buy,upro3_col_to_buy,upro3_crt_to_buy,
pro1_item_beh4,pro1_item_beh3,pro1_item_beh2,pro1_item_beh1,pro2_item_beh4,pro2_item_beh3,pro2_item_beh2,pro2_item_beh1,
pro3_item_beh4,pro3_item_beh3,pro3_item_beh2,pro3_item_beh1,idiff1,idiff2,idiff3,iavghour1,iavghour2,iavghour3,
ipro1_bws_to_buy,ipro1_col_to_buy,ipro1_crt_to_buy,ipro2_bws_to_buy,ipro2_col_to_buy,ipro2_crt_to_buy,ipro3_bws_to_buy,
ipro3_col_to_buy,ipro3_crt_to_buy,pro1_chr4_cnt,pro2_chr4_cnt,pro3_chr4_cnt,pro1_chr3_cnt,pro2_chr3_cnt,pro3_chr3_cnt,
pro1_chr2_cnt,pro2_chr2_cnt,pro3_chr2_cnt,pro1_geo_range,pro2_geo_range,pro3_geo_range,
--item_category,
item_carttobuyrate,
item_collecttobuyrate,item_browsetobuyrate,item_in_category_buy_rate,item_in_category_cart_rate,item_in_category_collect_rate,
item_in_category_browse_rate,category_in_categoryies_buys_rate,category_in_categoryies_cart_rate,
category_in_categoryies_collect_rate,category_in_categoryies_browse_rate,item_browsetobuyrate1,item_browsetobuyrate2,
item_browsetobuyrate3,item_collecttobuyrate1,item_collecttobuyrate2,item_collecttobuyrate3,item_carttobuyrate1,
item_carttobuyrate2,item_carttobuyrate3,item_browsetobuyrate1_recent3d,item_browsetobuyrate2_recent3d,item_browsetobuyrate3_recent3d,
item_collecttobuyrate1_recent3d,item_collecttobuyrate2_recent3d,item_collecttobuyrate3_recent3d,item_carttobuyrate1_recent3d,
item_carttobuyrate2_recent3d,item_carttobuyrate3_recent3d,item_carttobuyrate_recent3d,item_collecttobuyrate_recent3d,item_browsetobuyrate_recent3d,
item_in_category_buy_rate_recent3d,item_in_category_cart_rate_recent3d,item_in_category_collect_rate_recent3d,item_in_category_browse_rate_recent3d,
user_carttobuyrate,user_catg_carttobuyrate,user_collecttobuyrate,user_catg_collecttobuyrate,user_browsetobuyrate,user_catg_browsetobuyrate,
--ui_item_carttobuyrate_dense_rank,ui_item_carttobuyrate_percent_rank,ui_item_collecttobuyrate_dense_rank,ui_item_collecttobuyrate_percent_rank,ui_item_browsetobuyrate_dense_rank,
--ui_item_browsetobuyrate_percent_rank,ui_item_in_category_buy_rate_dense_rank,ui_item_in_category_buy_rate_percent_rank,ui_item_in_category_cart_rate_dense_rank
--,ui_iteam_in_category_cart_rate_percent_rank,ui_item_in_category_collect_rate_dense_rank,ui_item_in_category_collect_rate_percent_rank,
--ui_item_in_category_browse_rate_dense_rank,ui_item_in_category_browse_rate_percent_rank,ui_item_browsetobuyrate1_dense_rank,
--ui_item_browsetobuyrate1_percent_rank,ui_item_browsetobuyrate2_dense_rank,ui_item_browsetobuyrate2_percent_rank,
--ui_item_browsetobuyrate3_dense_rank,ui_item_browsetobuyrate3_percent_rank,ui_item_collecttobuyrate1_dense_rank,
--ui_item_collecttobuyrate1_percent_rank,ui_item_collecttobuyrate2_dense_rank,ui_item_collecttobuyrate2_percent_rank,
--ui_item_collecttobuyrate3_dense_rank,ui_item_collecttobuyrate3_percent_rank,ui_item_carttobuyrate1_dense_rank,
--ui_item_carttobuyrate1_percent_rank,ui_item_carttobuyrate2_dense_rank,ui_item_carttobuyrate2_percent_rank,
--ui_item_carttobuyrate3_dense_rank,ui_item_carttobuyrate3_percent_rank,ui_item_browsetobuyrate1_recent3d_dense_rank,
--ui_item_browsetobuyrate1_recent3d_percent_rank,ui_item_browsetobuyrate2_recent3d_dense_rank,ui_item_browsetobuyrate2_recent3d_percent_rank,
--ui_item_browsetobuyrate3_recent3d_dense_rank,ui_item_browsetobuyrate3_recent3d_percent_rank,ui_item_collecttobuyrate1_recent3d_dense_rank,
--ui_item_collecttobuyrate1_recent3d_percent_rank,ui_item_collecttobuyrate2_recent3d_dense_rank,ui_item_collecttobuyrate2_recent3d_percent_rank,
--ui_item_collecttobuyrate3_recent3d_dense_rank,ui_item_collecttobuyrate3_recent3d_percent_rank,ui_item_carttobuyrate1_recent3d_dense_rank
--,ui_item_carttobuyrate1_recent3d_percent_rank,ui_item_carttobuyrate2_recent3d_dense_rank,ui_item_carttobuyrate2_recent3d_percent_rank,
--ui_item_carttobuyrate3_recent3d_dense_rank,ui_item_carttobuyrate3_recent3d_percent_rank,ui_item_carttobuyrate_recent3d_dense_rank,
--ui_item_carttobuyrate_recent3d_percent_rank,ui_item_collecttobuyrate_recent3d_dense_rank,ui_item_collecttobuyrate_recent3d_percent_rank
--,ui_item_browsetobuyrate_recent3d_dense_rank,ui_item_browsetobuyrate_recent3d_percent_rank,ui_item_in_category_buy_rate_recent3d_dense_rank,
--ui_item_in_category_buy_rate_recent3d_percent_rank,ui_item_in_category_cart_rate_recent3d_dense_rank,ui_item_in_category_cart_rate_recent3d_percent_rank,
--ui_item_in_category_collect_rate_recent3d_dense_rank,ui_item_in_category_collect_rate_recent3d_percent_rank,ui_item_in_category_browse_rate_recent3d_dense_rank,
--ui_item_in_category_browse_rate_recent3d_percent_rank,uc1_dense_rank,uc1_percent_rank,ui1_dense_rank,ui1_percent_rank,uc2_dense_rank,uc2_percent_rank,
--ui2_dense_rank,ui2_percent_rank,
last_all_score,item_buy_cnt,user_buy_cnt,
---user_next1daybuy_num,item_next1daybuy_num,
geo_diff_rep,item_buy_cnt3,item_buy_cnt2,user_buy_cnt3,user_buy_cnt2,crt_buy_cnt,crt_nobuy_cnt,col_buy_cnt,col_nobuy_cnt,bws_buy_cnt,
bws_nobuy_cnt,pro1_buyincate_cnt,pro1_crtincate_cnt,pro1_colincate_cnt,pro1_bwsincate_cnt,pro2_buyincate_cnt,pro2_crtincate_cnt,pro2_colincate_cnt,pro2_bwsincate_cnt
 from jun1_uic_b1_train t1 left outer join 17day_combine_backup_0521 t2
 on t1.user_id=t2.user_id and t1.item_id=t2.item_id;