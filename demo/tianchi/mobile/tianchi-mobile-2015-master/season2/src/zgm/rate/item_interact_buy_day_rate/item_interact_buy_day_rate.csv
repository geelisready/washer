drop table if exists 18day_combine_backup_0531;
create table 18day_combine_backup_0531 as 
select user_id,item_id,
hour00,hour01,hour02,hour03,hour04,hour05,hour06,hour07,hour08,hour09,hour10,hour11,
hour12,hour13,hour14,hour15,hour16,hour17,hour18,hour19,hour20,hour21,hour22,hour23,
last_collect_hour,last_cart_hour,last_browse_time_span,last_browse_times,last_operate_weight_times,last_operate_time,
last_2_click_times,last_2_operate_times,last_2_collect_hour,last_2_cart_hour,last_2_browse_time_span,
label,
pro1_user_beh4,pro1_user_beh3,pro1_user_beh2,pro1_user_beh1,
pro2_user_beh4,pro2_user_beh3,pro2_user_beh2,pro2_user_beh1,
pro3_user_beh4,pro3_user_beh3,pro3_user_beh2,pro3_user_beh1,
udiff1,udiff2,udiff3,-----最近的N天商品每天的活跃时长activehour---
uavghour1,uavghour2,uavghour3,--user最近n天的平均活跃时间---
upro1_bws_to_buy,upro1_col_to_buy,upro1_crt_to_buy,
upro2_bws_to_buy,upro2_col_to_buy,upro2_crt_to_buy,
upro3_bws_to_buy,upro3_col_to_buy,upro3_crt_to_buy,
pro1_item_beh4,pro1_item_beh3,pro1_item_beh2,pro1_item_beh1,
pro2_item_beh4,pro2_item_beh3,pro2_item_beh2,pro2_item_beh1,
pro3_item_beh4,pro3_item_beh3,pro3_item_beh2,pro3_item_beh1,
idiff1,idiff2,idiff3,
iavghour1,iavghour2,iavghour3,
ipro1_bws_to_buy,ipro1_col_to_buy,ipro1_crt_to_buy,
ipro2_bws_to_buy,ipro2_col_to_buy,ipro2_crt_to_buy,
ipro3_bws_to_buy,ipro3_col_to_buy,ipro3_crt_to_buy,
pro1_chr4_cnt,pro2_chr4_cnt,pro3_chr4_cnt,
pro1_chr3_cnt,pro2_chr3_cnt,pro3_chr3_cnt,
pro1_chr2_cnt,pro2_chr2_cnt,pro3_chr2_cnt,
pro1_geo_range,pro2_geo_range,pro3_geo_range,-----需要进一步了解---
item_category,
item_carttobuyrate,item_collecttobuyrate,item_browsetobuyrate,
item_in_category_buy_rate,item_in_category_cart_rate,item_in_category_collect_rate,item_in_category_browse_rate,
category_in_categoryies_buys_rate,category_in_categoryies_cart_rate,category_in_categoryies_collect_rate,category_in_categoryies_browse_rate,---category的性质，略显得不太重要，先放着---
item_browsetobuyrate1,item_browsetobuyrate2,item_browsetobuyrate3,-----三种不同情况计算browse to buy rate ，前面还有一种，共4中，每种计算都不一样----
item_collecttobuyrate1,item_collecttobuyrate2,item_collecttobuyrate3,
item_carttobuyrate1,item_carttobuyrate2,item_carttobuyrate3,
item_browsetobuyrate1_recent3d,item_browsetobuyrate2_recent3d,item_browsetobuyrate3_recent3d,
item_collecttobuyrate1_recent3d,item_collecttobuyrate2_recent3d,item_collecttobuyrate3_recent3d,
item_carttobuyrate1_recent3d,item_carttobuyrate2_recent3d,item_carttobuyrate3_recent3d,
item_carttobuyrate_recent3d,item_collecttobuyrate_recent3d,item_browsetobuyrate_recent3d,
item_in_category_buy_rate_recent3d,item_in_category_cart_rate_recent3d,item_in_category_collect_rate_recent3d,item_in_category_browse_rate_recent3d,

user_carttobuyrate,user_catg_carttobuyrate,
user_collecttobuyrate,user_catg_collecttobuyrate,
user_browsetobuyrate,user_catg_browsetobuyrate,

ui_item_carttobuyrate_dense_rank,ui_item_carttobuyrate_percent_rank,----可能需要进一步调整，有些用户没有cart操作，排这个用处不大----
ui_item_collecttobuyrate_dense_rank,ui_item_collecttobuyrate_percent_rank,
ui_item_browsetobuyrate_dense_rank,ui_item_browsetobuyrate_percent_rank,
ui_item_in_category_buy_rate_dense_rank,ui_item_in_category_buy_rate_percent_rank,
ui_item_in_category_cart_rate_dense_rank,ui_item_in_category_cart_rate_percent_rank,
ui_item_in_category_collect_rate_dense_rank,ui_item_in_category_collect_rate_percent_rank,
ui_item_in_category_browse_rate_dense_rank,ui_item_in_category_browse_rate_percent_rank,
ui_item_browsetobuyrate1_dense_rank,ui_item_browsetobuyrate1_percent_rank,
ui_item_browsetobuyrate2_dense_rank,ui_item_browsetobuyrate2_percent_rank,
ui_item_browsetobuyrate3_dense_rank,ui_item_browsetobuyrate3_percent_rank,
ui_item_collecttobuyrate1_dense_rank,ui_item_collecttobuyrate1_percent_rank,
ui_item_collecttobuyrate2_dense_rank,ui_item_collecttobuyrate2_percent_rank,
ui_item_collecttobuyrate3_dense_rank,ui_item_collecttobuyrate3_percent_rank,
ui_item_carttobuyrate1_dense_rank,ui_item_carttobuyrate1_percent_rank,
ui_item_carttobuyrate2_dense_rank,ui_item_carttobuyrate2_percent_rank,
ui_item_carttobuyrate3_dense_rank,ui_item_carttobuyrate3_percent_rank,
ui_item_browsetobuyrate1_recent3d_dense_rank,ui_item_browsetobuyrate1_recent3d_percent_rank,
ui_item_browsetobuyrate2_recent3d_dense_rank,ui_item_browsetobuyrate2_recent3d_percent_rank,
ui_item_browsetobuyrate3_recent3d_dense_rank,ui_item_browsetobuyrate3_recent3d_percent_rank,
ui_item_collecttobuyrate1_recent3d_dense_rank,ui_item_collecttobuyrate1_recent3d_percent_rank,
ui_item_collecttobuyrate2_recent3d_dense_rank,ui_item_collecttobuyrate2_recent3d_percent_rank,
ui_item_collecttobuyrate3_recent3d_dense_rank,ui_item_collecttobuyrate3_recent3d_percent_rank,
ui_item_carttobuyrate1_recent3d_dense_rank,ui_item_carttobuyrate1_recent3d_percent_rank,
ui_item_carttobuyrate2_recent3d_dense_rank,ui_item_carttobuyrate2_recent3d_percent_rank,
ui_item_carttobuyrate3_recent3d_dense_rank,ui_item_carttobuyrate3_recent3d_percent_rank,
ui_item_carttobuyrate_recent3d_dense_rank,ui_item_carttobuyrate_recent3d_percent_rank,
ui_item_collecttobuyrate_recent3d_dense_rank,ui_item_collecttobuyrate_recent3d_percent_rank,
ui_item_browsetobuyrate_recent3d_dense_rank,ui_item_browsetobuyrate_recent3d_percent_rank,
ui_item_in_category_buy_rate_recent3d_dense_rank,ui_item_in_category_buy_rate_recent3d_percent_rank,
ui_item_in_category_cart_rate_recent3d_dense_rank,ui_item_in_category_cart_rate_recent3d_percent_rank,
ui_item_in_category_collect_rate_recent3d_dense_rank,ui_item_in_category_collect_rate_recent3d_percent_rank,
ui_item_in_category_browse_rate_recent3d_dense_rank,ui_item_in_category_browse_rate_recent3d_percent_rank,
uc1_dense_rank,uc1_percent_rank,ui1_dense_rank,ui1_percent_rank,------TODO----
uc2_dense_rank,uc2_percent_rank,ui2_dense_rank,ui2_percent_rank,
uc_item_in_category_buy_rate_dense_rank,uc_item_in_category_buy_rate_percent_rank,
uc_item_carttobuyrate_dense_rank,uc_item_carttobuyrate_percent_rank,

user_next1daybuy_num,item_next1daybuy_num,----隔天购买次数----need to加入隔天购买概率---
last_all_score,--非常有用---
item_buy_cnt,user_buy_cnt,---总体的吗？--
geo_diff_rep,
item_buy_cnt3,item_buy_cnt2,
user_buy_cnt3,user_buy_cnt2,
crt_buy_cnt,crt_nobuy_cnt,
col_buy_cnt,col_nobuy_cnt,
bws_buy_cnt,bws_nobuy_cnt,
pro1_buyincate_cnt,pro1_crtincate_cnt,pro1_colincate_cnt,pro1_bwsincate_cnt,
pro2_buyincate_cnt,pro2_crtincate_cnt,pro2_colincate_cnt,pro2_bwsincate_cnt,
last_browse_score,last_collect_score,last_cart_score,
u_last_category_browse_times,u_last_all_browse_times,
u_last_category_collect_times,u_last_all_collect_times,
u_last_category_cart_times,u_last_all_cart_times,
ui_last_category_browse_times_rate,ui_last_all_browse_times_rate,
ui_last_category_collect_times_rate,ui_last_all_collect_times_rate,
ui_last_category_cart_times_rate,ui_last_all_cart_times_rate,

ui_last_browse_score_dense_rank,ui_last_browse_score_percent_rank,
ui_last_collect_score_dense_rank,ui_last_collect_score_percent_rank,
ui_last_cart_score_dense_rank,ui_last_cart_score_percent_rank,
ui_u_last_category_browse_times_dense_rank,ui_u_last_category_browse_times_percent_rank,---user对各个category的浏览次数排序
ui_u_last_category_collect_times_dense_rank,ui_u_last_category_collect_times_percent_rank,
ui_u_last_category_cart_times_dense_rank,ui_u_last_category_cart_times_percent_rank,
ui_ui_last_category_browse_times_rate_dense_rank,ui_ui_last_category_browse_times_rate_percent_rank,
ui_ui_last_all_browse_times_rate_dense_rank,ui_ui_last_all_browse_times_rate_percent_rank,
ui_ui_last_category_collect_times_rate_dense_rank,ui_ui_last_category_collect_times_rate_percent_rank,
ui_ui_last_category_cart_times_rate_dense_rank,ui_ui_last_category_cart_times_rate_percent_rank,

ui_last_all_score_dense_rank,ui_last_all_score_percent_rank,
uc_last_browse_score_dense_rank,uc_last_browse_score_percent_rank,
uc_last_collect_score_dense_rank,uc_last_collect_score_percent_rank,
uc_last_cart_score_dense_rank,uc_last_cart_score_percent_rank,

uc_ui_last_category_browse_times_rate_dense_rank,uc_ui_last_category_browse_times_rate_percent_rank,
uc_ui_last_all_browse_times_rate_dense_rank,uc_ui_last_all_browse_times_rate_percent_rank,

uc_last_all_score_dense_rank,uc_last_all_score_percent_rank,
uc_last_collect_hour_dense_rank,uc_last_collect_hour_percent_rank,
uc_last_cart_hour_dense_rank,uc_last_cart_hour_percent_rank,

uc_last_operate_weight_times_dense_rank,uc_last_operate_weight_times_percent_rank,
uc_last_operate_time_dense_rank,uc_last_operate_time_percent_rank,
uc_last_operate_time_combine_dense_rank,uc_last_operate_time_combine_percent_rank,

pro2w_log_prob,pro3w_log_prob,pro4w_log_prob,
pro2w_buy_prob,pro3w_buy_prob,pro4w_buy_prob,
pro2w_buy_times,pro3w_buy_times,pro4w_buy_times,
pro2w_log_prob_ui,pro3w_log_prob_ui,pro4w_log_prob_ui,----是不是需要加入uc---
pro2w_buy_prob_ui,pro3w_buy_prob_ui,pro4w_buy_prob_ui,
pro2w_buy_times_i,pro3w_buy_times_i,pro4w_buy_times_i,

crt_buy_cnt_incate_drank,crt_buy_cnt_incate_prank,
col_buy_cnt_incate_drank,col_buy_cnt_incate_prank,
bws_buy_cnt_incate_drank,bws_buy_cnt_incate_prank,
buy_cnt_incate_drank,buy_cnt_incate_prank,
pro1_beh_incate_drank,pro1_beh_incate_prank,
pro2_beh_incate_drank,pro2_beh_incate_prank,
beh_nobuy_drank,beh_nobuy_prank,
pro1_buy_times,pro1_crt_times,pro1_col_times,
pro3_buy_times,pro3_crt_times,pro3_col_times,pro3_bws_times,
pro7_buy_times,pro7_crt_times,pro7_col_times,pro7_bws_times,
pro11_buy_times,pro11_crt_times,pro11_col_times,pro11_bws_times,

pro1_buy_times_h,pro1_crt_times_h,pro1_col_times_h,pro1_bws_times_h,--------？？？-----
pro3_buy_times_h,pro3_crt_times_h,pro3_col_times_h,pro3_bws_times_h,
pro17_buy_times,pro17_crt_times,pro17_col_times,pro17_bws_times,

case when u_recent_2d_interact_days==-1 then -1
     else (u_recent_2d_buy_days+1)/(u_recent_2d_interact_days+1) 
end  as u_recent_2d_interact_buy_prob,
case when u_recent_3d_interact_days==-1 then -1
     else (u_recent_3d_buy_days+1)/(u_recent_3d_interact_days+1) 
end  as u_recent_3d_interact_buy_prob,

case when u_recent_4d_interact_days==-1 then -1
     else (u_recent_4d_buy_days+1)/(u_recent_4d_interact_days+1) 
end  as u_recent_4d_interact_buy_prob,


case when u_recent_5d_interact_days==-1 then -1
     else (u_recent_5d_buy_days+1)/(u_recent_5d_interact_days+1) 
end  as u_recent_5d_interact_buy_prob,

case when u_recent_7d_interact_days==-1 then -1
     else (u_recent_7d_buy_days+1)/(u_recent_7d_interact_days+1) 
end  as u_recent_7d_interact_buy_prob,

case when u_recent_15d_interact_days==-1 then -1
     else (u_recent_15d_buy_days+1)/(u_recent_15d_interact_days+1) 
end  as u_recent_15d_interact_buy_prob,
case when u_recent_26d_interact_days==-1 then -1
     else (u_recent_26d_buy_days+1)/(u_recent_26d_interact_days+1) 
end  as u_recent_26d_interact_buy_prob,

case when i_recent_2d_interact_days==-1 then -1
     else (i_recent_2d_buy_days+1)/(i_recent_2d_interact_days+1) 
end  as i_recent_2d_interact_buy_prob,
case when i_recent_3d_interact_days==-1 then -1
     else (i_recent_3d_buy_days+1)/(i_recent_3d_interact_days+1) 
end  as i_recent_3d_interact_buy_prob,

case when i_recent_4d_interact_days==-1 then -1
     else (i_recent_4d_buy_days+1)/(i_recent_4d_interact_days+1) 
end  as i_recent_4d_interact_buy_prob,

case when i_recent_5d_interact_days==-1 then -1
     else (i_recent_5d_buy_days+1)/(i_recent_5d_interact_days+1) 
end  as i_recent_5d_interact_buy_prob,

case when i_recent_7d_interact_days==-1 then -1
     else (i_recent_7d_buy_days+1)/(i_recent_7d_interact_days+1) 
end  as i_recent_7d_interact_buy_prob,

case when i_recent_15d_interact_days==-1 then -1
     else (i_recent_15d_buy_days+1)/(i_recent_15d_interact_days+1) 
end  as i_recent_15d_interact_buy_prob,
case when i_recent_26d_interact_days==-1 then -1
     else (i_recent_26d_buy_days+1)/(i_recent_26d_interact_days+1) 
end  as i_recent_26d_interact_buy_prob

from 18day_combine;


drop table if exists 17day_combine_backup_0531;
create table 17day_combine_backup_0531 as 
select user_id,item_id,
hour00,hour01,hour02,hour03,hour04,hour05,hour06,hour07,hour08,hour09,hour10,hour11,
hour12,hour13,hour14,hour15,hour16,hour17,hour18,hour19,hour20,hour21,hour22,hour23,
last_collect_hour,last_cart_hour,last_browse_time_span,last_browse_times,last_operate_weight_times,last_operate_time,
last_2_click_times,last_2_operate_times,last_2_collect_hour,last_2_cart_hour,last_2_browse_time_span,
label,
pro1_user_beh4,pro1_user_beh3,pro1_user_beh2,pro1_user_beh1,
pro2_user_beh4,pro2_user_beh3,pro2_user_beh2,pro2_user_beh1,
pro3_user_beh4,pro3_user_beh3,pro3_user_beh2,pro3_user_beh1,
udiff1,udiff2,udiff3,-----最近的N天商品每天的活跃时长activehour---
uavghour1,uavghour2,uavghour3,--user最近n天的平均活跃时间---
upro1_bws_to_buy,upro1_col_to_buy,upro1_crt_to_buy,
upro2_bws_to_buy,upro2_col_to_buy,upro2_crt_to_buy,
upro3_bws_to_buy,upro3_col_to_buy,upro3_crt_to_buy,
pro1_item_beh4,pro1_item_beh3,pro1_item_beh2,pro1_item_beh1,
pro2_item_beh4,pro2_item_beh3,pro2_item_beh2,pro2_item_beh1,
pro3_item_beh4,pro3_item_beh3,pro3_item_beh2,pro3_item_beh1,
idiff1,idiff2,idiff3,
iavghour1,iavghour2,iavghour3,
ipro1_bws_to_buy,ipro1_col_to_buy,ipro1_crt_to_buy,
ipro2_bws_to_buy,ipro2_col_to_buy,ipro2_crt_to_buy,
ipro3_bws_to_buy,ipro3_col_to_buy,ipro3_crt_to_buy,
pro1_chr4_cnt,pro2_chr4_cnt,pro3_chr4_cnt,
pro1_chr3_cnt,pro2_chr3_cnt,pro3_chr3_cnt,
pro1_chr2_cnt,pro2_chr2_cnt,pro3_chr2_cnt,
pro1_geo_range,pro2_geo_range,pro3_geo_range,-----需要进一步了解---
item_category,
item_carttobuyrate,item_collecttobuyrate,item_browsetobuyrate,
item_in_category_buy_rate,item_in_category_cart_rate,item_in_category_collect_rate,item_in_category_browse_rate,
category_in_categoryies_buys_rate,category_in_categoryies_cart_rate,category_in_categoryies_collect_rate,category_in_categoryies_browse_rate,---category的性质，略显得不太重要，先放着---
item_browsetobuyrate1,item_browsetobuyrate2,item_browsetobuyrate3,-----三种不同情况计算browse to buy rate ，前面还有一种，共4中，每种计算都不一样----
item_collecttobuyrate1,item_collecttobuyrate2,item_collecttobuyrate3,
item_carttobuyrate1,item_carttobuyrate2,item_carttobuyrate3,
item_browsetobuyrate1_recent3d,item_browsetobuyrate2_recent3d,item_browsetobuyrate3_recent3d,
item_collecttobuyrate1_recent3d,item_collecttobuyrate2_recent3d,item_collecttobuyrate3_recent3d,
item_carttobuyrate1_recent3d,item_carttobuyrate2_recent3d,item_carttobuyrate3_recent3d,
item_carttobuyrate_recent3d,item_collecttobuyrate_recent3d,item_browsetobuyrate_recent3d,
item_in_category_buy_rate_recent3d,item_in_category_cart_rate_recent3d,item_in_category_collect_rate_recent3d,item_in_category_browse_rate_recent3d,

user_carttobuyrate,user_catg_carttobuyrate,
user_collecttobuyrate,user_catg_collecttobuyrate,
user_browsetobuyrate,user_catg_browsetobuyrate,

ui_item_carttobuyrate_dense_rank,ui_item_carttobuyrate_percent_rank,----可能需要进一步调整，有些用户没有cart操作，排这个用处不大----
ui_item_collecttobuyrate_dense_rank,ui_item_collecttobuyrate_percent_rank,
ui_item_browsetobuyrate_dense_rank,ui_item_browsetobuyrate_percent_rank,
ui_item_in_category_buy_rate_dense_rank,ui_item_in_category_buy_rate_percent_rank,
ui_item_in_category_cart_rate_dense_rank,ui_item_in_category_cart_rate_percent_rank,
ui_item_in_category_collect_rate_dense_rank,ui_item_in_category_collect_rate_percent_rank,
ui_item_in_category_browse_rate_dense_rank,ui_item_in_category_browse_rate_percent_rank,
ui_item_browsetobuyrate1_dense_rank,ui_item_browsetobuyrate1_percent_rank,
ui_item_browsetobuyrate2_dense_rank,ui_item_browsetobuyrate2_percent_rank,
ui_item_browsetobuyrate3_dense_rank,ui_item_browsetobuyrate3_percent_rank,
ui_item_collecttobuyrate1_dense_rank,ui_item_collecttobuyrate1_percent_rank,
ui_item_collecttobuyrate2_dense_rank,ui_item_collecttobuyrate2_percent_rank,
ui_item_collecttobuyrate3_dense_rank,ui_item_collecttobuyrate3_percent_rank,
ui_item_carttobuyrate1_dense_rank,ui_item_carttobuyrate1_percent_rank,
ui_item_carttobuyrate2_dense_rank,ui_item_carttobuyrate2_percent_rank,
ui_item_carttobuyrate3_dense_rank,ui_item_carttobuyrate3_percent_rank,
ui_item_browsetobuyrate1_recent3d_dense_rank,ui_item_browsetobuyrate1_recent3d_percent_rank,
ui_item_browsetobuyrate2_recent3d_dense_rank,ui_item_browsetobuyrate2_recent3d_percent_rank,
ui_item_browsetobuyrate3_recent3d_dense_rank,ui_item_browsetobuyrate3_recent3d_percent_rank,
ui_item_collecttobuyrate1_recent3d_dense_rank,ui_item_collecttobuyrate1_recent3d_percent_rank,
ui_item_collecttobuyrate2_recent3d_dense_rank,ui_item_collecttobuyrate2_recent3d_percent_rank,
ui_item_collecttobuyrate3_recent3d_dense_rank,ui_item_collecttobuyrate3_recent3d_percent_rank,
ui_item_carttobuyrate1_recent3d_dense_rank,ui_item_carttobuyrate1_recent3d_percent_rank,
ui_item_carttobuyrate2_recent3d_dense_rank,ui_item_carttobuyrate2_recent3d_percent_rank,
ui_item_carttobuyrate3_recent3d_dense_rank,ui_item_carttobuyrate3_recent3d_percent_rank,
ui_item_carttobuyrate_recent3d_dense_rank,ui_item_carttobuyrate_recent3d_percent_rank,
ui_item_collecttobuyrate_recent3d_dense_rank,ui_item_collecttobuyrate_recent3d_percent_rank,
ui_item_browsetobuyrate_recent3d_dense_rank,ui_item_browsetobuyrate_recent3d_percent_rank,
ui_item_in_category_buy_rate_recent3d_dense_rank,ui_item_in_category_buy_rate_recent3d_percent_rank,
ui_item_in_category_cart_rate_recent3d_dense_rank,ui_item_in_category_cart_rate_recent3d_percent_rank,
ui_item_in_category_collect_rate_recent3d_dense_rank,ui_item_in_category_collect_rate_recent3d_percent_rank,
ui_item_in_category_browse_rate_recent3d_dense_rank,ui_item_in_category_browse_rate_recent3d_percent_rank,
uc1_dense_rank,uc1_percent_rank,ui1_dense_rank,ui1_percent_rank,------TODO----
uc2_dense_rank,uc2_percent_rank,ui2_dense_rank,ui2_percent_rank,
uc_item_in_category_buy_rate_dense_rank,uc_item_in_category_buy_rate_percent_rank,
uc_item_carttobuyrate_dense_rank,uc_item_carttobuyrate_percent_rank,

user_next1daybuy_num,item_next1daybuy_num,----隔天购买次数----need to加入隔天购买概率---
last_all_score,--非常有用---
item_buy_cnt,user_buy_cnt,---总体的吗？--
geo_diff_rep,
item_buy_cnt3,item_buy_cnt2,
user_buy_cnt3,user_buy_cnt2,
crt_buy_cnt,crt_nobuy_cnt,
col_buy_cnt,col_nobuy_cnt,
bws_buy_cnt,bws_nobuy_cnt,
pro1_buyincate_cnt,pro1_crtincate_cnt,pro1_colincate_cnt,pro1_bwsincate_cnt,
pro2_buyincate_cnt,pro2_crtincate_cnt,pro2_colincate_cnt,pro2_bwsincate_cnt,
last_browse_score,last_collect_score,last_cart_score,
u_last_category_browse_times,u_last_all_browse_times,
u_last_category_collect_times,u_last_all_collect_times,
u_last_category_cart_times,u_last_all_cart_times,
ui_last_category_browse_times_rate,ui_last_all_browse_times_rate,
ui_last_category_collect_times_rate,ui_last_all_collect_times_rate,
ui_last_category_cart_times_rate,ui_last_all_cart_times_rate,

ui_last_browse_score_dense_rank,ui_last_browse_score_percent_rank,
ui_last_collect_score_dense_rank,ui_last_collect_score_percent_rank,
ui_last_cart_score_dense_rank,ui_last_cart_score_percent_rank,
ui_u_last_category_browse_times_dense_rank,ui_u_last_category_browse_times_percent_rank,---user对各个category的浏览次数排序
ui_u_last_category_collect_times_dense_rank,ui_u_last_category_collect_times_percent_rank,
ui_u_last_category_cart_times_dense_rank,ui_u_last_category_cart_times_percent_rank,
ui_ui_last_category_browse_times_rate_dense_rank,ui_ui_last_category_browse_times_rate_percent_rank,
ui_ui_last_all_browse_times_rate_dense_rank,ui_ui_last_all_browse_times_rate_percent_rank,
ui_ui_last_category_collect_times_rate_dense_rank,ui_ui_last_category_collect_times_rate_percent_rank,
ui_ui_last_category_cart_times_rate_dense_rank,ui_ui_last_category_cart_times_rate_percent_rank,

ui_last_all_score_dense_rank,ui_last_all_score_percent_rank,
uc_last_browse_score_dense_rank,uc_last_browse_score_percent_rank,
uc_last_collect_score_dense_rank,uc_last_collect_score_percent_rank,
uc_last_cart_score_dense_rank,uc_last_cart_score_percent_rank,

uc_ui_last_category_browse_times_rate_dense_rank,uc_ui_last_category_browse_times_rate_percent_rank,
uc_ui_last_all_browse_times_rate_dense_rank,uc_ui_last_all_browse_times_rate_percent_rank,

uc_last_all_score_dense_rank,uc_last_all_score_percent_rank,
uc_last_collect_hour_dense_rank,uc_last_collect_hour_percent_rank,
uc_last_cart_hour_dense_rank,uc_last_cart_hour_percent_rank,

uc_last_operate_weight_times_dense_rank,uc_last_operate_weight_times_percent_rank,
uc_last_operate_time_dense_rank,uc_last_operate_time_percent_rank,
uc_last_operate_time_combine_dense_rank,uc_last_operate_time_combine_percent_rank,

pro2w_log_prob,pro3w_log_prob,pro4w_log_prob,
pro2w_buy_prob,pro3w_buy_prob,pro4w_buy_prob,
pro2w_buy_times,pro3w_buy_times,pro4w_buy_times,
pro2w_log_prob_ui,pro3w_log_prob_ui,pro4w_log_prob_ui,----是不是需要加入uc---
pro2w_buy_prob_ui,pro3w_buy_prob_ui,pro4w_buy_prob_ui,
pro2w_buy_times_i,pro3w_buy_times_i,pro4w_buy_times_i,

crt_buy_cnt_incate_drank,crt_buy_cnt_incate_prank,
col_buy_cnt_incate_drank,col_buy_cnt_incate_prank,
bws_buy_cnt_incate_drank,bws_buy_cnt_incate_prank,
buy_cnt_incate_drank,buy_cnt_incate_prank,
pro1_beh_incate_drank,pro1_beh_incate_prank,
pro2_beh_incate_drank,pro2_beh_incate_prank,
beh_nobuy_drank,beh_nobuy_prank,
pro1_buy_times,pro1_crt_times,pro1_col_times,
pro3_buy_times,pro3_crt_times,pro3_col_times,pro3_bws_times,
pro7_buy_times,pro7_crt_times,pro7_col_times,pro7_bws_times,
pro11_buy_times,pro11_crt_times,pro11_col_times,pro11_bws_times,

pro1_buy_times_h,pro1_crt_times_h,pro1_col_times_h,pro1_bws_times_h,--------？？？-----
pro3_buy_times_h,pro3_crt_times_h,pro3_col_times_h,pro3_bws_times_h,
pro17_buy_times,pro17_crt_times,pro17_col_times,pro17_bws_times,

case when u_recent_2d_interact_days==-1 then -1
     else (u_recent_2d_buy_days+1)/(u_recent_2d_interact_days+1) 
end  as u_recent_2d_interact_buy_prob,
case when u_recent_3d_interact_days==-1 then -1
     else (u_recent_3d_buy_days+1)/(u_recent_3d_interact_days+1) 
end  as u_recent_3d_interact_buy_prob,

case when u_recent_4d_interact_days==-1 then -1
     else (u_recent_4d_buy_days+1)/(u_recent_4d_interact_days+1) 
end  as u_recent_4d_interact_buy_prob,


case when u_recent_5d_interact_days==-1 then -1
     else (u_recent_5d_buy_days+1)/(u_recent_5d_interact_days+1) 
end  as u_recent_5d_interact_buy_prob,

case when u_recent_7d_interact_days==-1 then -1
     else (u_recent_7d_buy_days+1)/(u_recent_7d_interact_days+1) 
end  as u_recent_7d_interact_buy_prob,

case when u_recent_15d_interact_days==-1 then -1
     else (u_recent_15d_buy_days+1)/(u_recent_15d_interact_days+1) 
end  as u_recent_15d_interact_buy_prob,
case when u_recent_26d_interact_days==-1 then -1
     else (u_recent_26d_buy_days+1)/(u_recent_26d_interact_days+1) 
end  as u_recent_26d_interact_buy_prob,

case when i_recent_2d_interact_days==-1 then -1
     else (i_recent_2d_buy_days+1)/(i_recent_2d_interact_days+1) 
end  as i_recent_2d_interact_buy_prob,
case when i_recent_3d_interact_days==-1 then -1
     else (i_recent_3d_buy_days+1)/(i_recent_3d_interact_days+1) 
end  as i_recent_3d_interact_buy_prob,

case when i_recent_4d_interact_days==-1 then -1
     else (i_recent_4d_buy_days+1)/(i_recent_4d_interact_days+1) 
end  as i_recent_4d_interact_buy_prob,

case when i_recent_5d_interact_days==-1 then -1
     else (i_recent_5d_buy_days+1)/(i_recent_5d_interact_days+1) 
end  as i_recent_5d_interact_buy_prob,

case when i_recent_7d_interact_days==-1 then -1
     else (i_recent_7d_buy_days+1)/(i_recent_7d_interact_days+1) 
end  as i_recent_7d_interact_buy_prob,

case when i_recent_15d_interact_days==-1 then -1
     else (i_recent_15d_buy_days+1)/(i_recent_15d_interact_days+1) 
end  as i_recent_15d_interact_buy_prob,
case when i_recent_26d_interact_days==-1 then -1
     else (i_recent_26d_buy_days+1)/(i_recent_26d_interact_days+1) 
end  as i_recent_26d_interact_buy_prob

from 17day_combine;


drop table if exists 19day_combine_backup_0531;
create table 19day_combine_backup_0531 as 
select user_id,item_id,
hour00,hour01,hour02,hour03,hour04,hour05,hour06,hour07,hour08,hour09,hour10,hour11,
hour12,hour13,hour14,hour15,hour16,hour17,hour18,hour19,hour20,hour21,hour22,hour23,
last_collect_hour,last_cart_hour,last_browse_time_span,last_browse_times,last_operate_weight_times,last_operate_time,
last_2_click_times,last_2_operate_times,last_2_collect_hour,last_2_cart_hour,last_2_browse_time_span,
---label,
pro1_user_beh4,pro1_user_beh3,pro1_user_beh2,pro1_user_beh1,
pro2_user_beh4,pro2_user_beh3,pro2_user_beh2,pro2_user_beh1,
pro3_user_beh4,pro3_user_beh3,pro3_user_beh2,pro3_user_beh1,
udiff1,udiff2,udiff3,-----最近的N天商品每天的活跃时长activehour---
uavghour1,uavghour2,uavghour3,--user最近n天的平均活跃时间---
upro1_bws_to_buy,upro1_col_to_buy,upro1_crt_to_buy,
upro2_bws_to_buy,upro2_col_to_buy,upro2_crt_to_buy,
upro3_bws_to_buy,upro3_col_to_buy,upro3_crt_to_buy,
pro1_item_beh4,pro1_item_beh3,pro1_item_beh2,pro1_item_beh1,
pro2_item_beh4,pro2_item_beh3,pro2_item_beh2,pro2_item_beh1,
pro3_item_beh4,pro3_item_beh3,pro3_item_beh2,pro3_item_beh1,
idiff1,idiff2,idiff3,
iavghour1,iavghour2,iavghour3,
ipro1_bws_to_buy,ipro1_col_to_buy,ipro1_crt_to_buy,
ipro2_bws_to_buy,ipro2_col_to_buy,ipro2_crt_to_buy,
ipro3_bws_to_buy,ipro3_col_to_buy,ipro3_crt_to_buy,
pro1_chr4_cnt,pro2_chr4_cnt,pro3_chr4_cnt,
pro1_chr3_cnt,pro2_chr3_cnt,pro3_chr3_cnt,
pro1_chr2_cnt,pro2_chr2_cnt,pro3_chr2_cnt,
pro1_geo_range,pro2_geo_range,pro3_geo_range,-----需要进一步了解---
item_category,
item_carttobuyrate,item_collecttobuyrate,item_browsetobuyrate,
item_in_category_buy_rate,item_in_category_cart_rate,item_in_category_collect_rate,item_in_category_browse_rate,
category_in_categoryies_buys_rate,category_in_categoryies_cart_rate,category_in_categoryies_collect_rate,category_in_categoryies_browse_rate,---category的性质，略显得不太重要，先放着---
item_browsetobuyrate1,item_browsetobuyrate2,item_browsetobuyrate3,-----三种不同情况计算browse to buy rate ，前面还有一种，共4中，每种计算都不一样----
item_collecttobuyrate1,item_collecttobuyrate2,item_collecttobuyrate3,
item_carttobuyrate1,item_carttobuyrate2,item_carttobuyrate3,
item_browsetobuyrate1_recent3d,item_browsetobuyrate2_recent3d,item_browsetobuyrate3_recent3d,
item_collecttobuyrate1_recent3d,item_collecttobuyrate2_recent3d,item_collecttobuyrate3_recent3d,
item_carttobuyrate1_recent3d,item_carttobuyrate2_recent3d,item_carttobuyrate3_recent3d,
item_carttobuyrate_recent3d,item_collecttobuyrate_recent3d,item_browsetobuyrate_recent3d,
item_in_category_buy_rate_recent3d,item_in_category_cart_rate_recent3d,item_in_category_collect_rate_recent3d,item_in_category_browse_rate_recent3d,

user_carttobuyrate,user_catg_carttobuyrate,
user_collecttobuyrate,user_catg_collecttobuyrate,
user_browsetobuyrate,user_catg_browsetobuyrate,

ui_item_carttobuyrate_dense_rank,ui_item_carttobuyrate_percent_rank,----可能需要进一步调整，有些用户没有cart操作，排这个用处不大----
ui_item_collecttobuyrate_dense_rank,ui_item_collecttobuyrate_percent_rank,
ui_item_browsetobuyrate_dense_rank,ui_item_browsetobuyrate_percent_rank,
ui_item_in_category_buy_rate_dense_rank,ui_item_in_category_buy_rate_percent_rank,
ui_item_in_category_cart_rate_dense_rank,ui_item_in_category_cart_rate_percent_rank,
ui_item_in_category_collect_rate_dense_rank,ui_item_in_category_collect_rate_percent_rank,
ui_item_in_category_browse_rate_dense_rank,ui_item_in_category_browse_rate_percent_rank,
ui_item_browsetobuyrate1_dense_rank,ui_item_browsetobuyrate1_percent_rank,
ui_item_browsetobuyrate2_dense_rank,ui_item_browsetobuyrate2_percent_rank,
ui_item_browsetobuyrate3_dense_rank,ui_item_browsetobuyrate3_percent_rank,
ui_item_collecttobuyrate1_dense_rank,ui_item_collecttobuyrate1_percent_rank,
ui_item_collecttobuyrate2_dense_rank,ui_item_collecttobuyrate2_percent_rank,
ui_item_collecttobuyrate3_dense_rank,ui_item_collecttobuyrate3_percent_rank,
ui_item_carttobuyrate1_dense_rank,ui_item_carttobuyrate1_percent_rank,
ui_item_carttobuyrate2_dense_rank,ui_item_carttobuyrate2_percent_rank,
ui_item_carttobuyrate3_dense_rank,ui_item_carttobuyrate3_percent_rank,
ui_item_browsetobuyrate1_recent3d_dense_rank,ui_item_browsetobuyrate1_recent3d_percent_rank,
ui_item_browsetobuyrate2_recent3d_dense_rank,ui_item_browsetobuyrate2_recent3d_percent_rank,
ui_item_browsetobuyrate3_recent3d_dense_rank,ui_item_browsetobuyrate3_recent3d_percent_rank,
ui_item_collecttobuyrate1_recent3d_dense_rank,ui_item_collecttobuyrate1_recent3d_percent_rank,
ui_item_collecttobuyrate2_recent3d_dense_rank,ui_item_collecttobuyrate2_recent3d_percent_rank,
ui_item_collecttobuyrate3_recent3d_dense_rank,ui_item_collecttobuyrate3_recent3d_percent_rank,
ui_item_carttobuyrate1_recent3d_dense_rank,ui_item_carttobuyrate1_recent3d_percent_rank,
ui_item_carttobuyrate2_recent3d_dense_rank,ui_item_carttobuyrate2_recent3d_percent_rank,
ui_item_carttobuyrate3_recent3d_dense_rank,ui_item_carttobuyrate3_recent3d_percent_rank,
ui_item_carttobuyrate_recent3d_dense_rank,ui_item_carttobuyrate_recent3d_percent_rank,
ui_item_collecttobuyrate_recent3d_dense_rank,ui_item_collecttobuyrate_recent3d_percent_rank,
ui_item_browsetobuyrate_recent3d_dense_rank,ui_item_browsetobuyrate_recent3d_percent_rank,
ui_item_in_category_buy_rate_recent3d_dense_rank,ui_item_in_category_buy_rate_recent3d_percent_rank,
ui_item_in_category_cart_rate_recent3d_dense_rank,ui_item_in_category_cart_rate_recent3d_percent_rank,
ui_item_in_category_collect_rate_recent3d_dense_rank,ui_item_in_category_collect_rate_recent3d_percent_rank,
ui_item_in_category_browse_rate_recent3d_dense_rank,ui_item_in_category_browse_rate_recent3d_percent_rank,
uc1_dense_rank,uc1_percent_rank,ui1_dense_rank,ui1_percent_rank,------TODO----
uc2_dense_rank,uc2_percent_rank,ui2_dense_rank,ui2_percent_rank,
uc_item_in_category_buy_rate_dense_rank,uc_item_in_category_buy_rate_percent_rank,
uc_item_carttobuyrate_dense_rank,uc_item_carttobuyrate_percent_rank,

user_next1daybuy_num,item_next1daybuy_num,----隔天购买次数----need to加入隔天购买概率---
last_all_score,--非常有用---
item_buy_cnt,user_buy_cnt,---总体的吗？--
geo_diff_rep,
item_buy_cnt3,item_buy_cnt2,
user_buy_cnt3,user_buy_cnt2,
crt_buy_cnt,crt_nobuy_cnt,
col_buy_cnt,col_nobuy_cnt,
bws_buy_cnt,bws_nobuy_cnt,
pro1_buyincate_cnt,pro1_crtincate_cnt,pro1_colincate_cnt,pro1_bwsincate_cnt,
pro2_buyincate_cnt,pro2_crtincate_cnt,pro2_colincate_cnt,pro2_bwsincate_cnt,
last_browse_score,last_collect_score,last_cart_score,
u_last_category_browse_times,u_last_all_browse_times,
u_last_category_collect_times,u_last_all_collect_times,
u_last_category_cart_times,u_last_all_cart_times,
ui_last_category_browse_times_rate,ui_last_all_browse_times_rate,
ui_last_category_collect_times_rate,ui_last_all_collect_times_rate,
ui_last_category_cart_times_rate,ui_last_all_cart_times_rate,

ui_last_browse_score_dense_rank,ui_last_browse_score_percent_rank,
ui_last_collect_score_dense_rank,ui_last_collect_score_percent_rank,
ui_last_cart_score_dense_rank,ui_last_cart_score_percent_rank,
ui_u_last_category_browse_times_dense_rank,ui_u_last_category_browse_times_percent_rank,---user对各个category的浏览次数排序
ui_u_last_category_collect_times_dense_rank,ui_u_last_category_collect_times_percent_rank,
ui_u_last_category_cart_times_dense_rank,ui_u_last_category_cart_times_percent_rank,
ui_ui_last_category_browse_times_rate_dense_rank,ui_ui_last_category_browse_times_rate_percent_rank,
ui_ui_last_all_browse_times_rate_dense_rank,ui_ui_last_all_browse_times_rate_percent_rank,
ui_ui_last_category_collect_times_rate_dense_rank,ui_ui_last_category_collect_times_rate_percent_rank,
ui_ui_last_category_cart_times_rate_dense_rank,ui_ui_last_category_cart_times_rate_percent_rank,

ui_last_all_score_dense_rank,ui_last_all_score_percent_rank,
uc_last_browse_score_dense_rank,uc_last_browse_score_percent_rank,
uc_last_collect_score_dense_rank,uc_last_collect_score_percent_rank,
uc_last_cart_score_dense_rank,uc_last_cart_score_percent_rank,

uc_ui_last_category_browse_times_rate_dense_rank,uc_ui_last_category_browse_times_rate_percent_rank,
uc_ui_last_all_browse_times_rate_dense_rank,uc_ui_last_all_browse_times_rate_percent_rank,

uc_last_all_score_dense_rank,uc_last_all_score_percent_rank,
uc_last_collect_hour_dense_rank,uc_last_collect_hour_percent_rank,
uc_last_cart_hour_dense_rank,uc_last_cart_hour_percent_rank,

uc_last_operate_weight_times_dense_rank,uc_last_operate_weight_times_percent_rank,
uc_last_operate_time_dense_rank,uc_last_operate_time_percent_rank,
uc_last_operate_time_combine_dense_rank,uc_last_operate_time_combine_percent_rank,

pro2w_log_prob,pro3w_log_prob,pro4w_log_prob,
pro2w_buy_prob,pro3w_buy_prob,pro4w_buy_prob,
pro2w_buy_times,pro3w_buy_times,pro4w_buy_times,
pro2w_log_prob_ui,pro3w_log_prob_ui,pro4w_log_prob_ui,----是不是需要加入uc---
pro2w_buy_prob_ui,pro3w_buy_prob_ui,pro4w_buy_prob_ui,
pro2w_buy_times_i,pro3w_buy_times_i,pro4w_buy_times_i,

crt_buy_cnt_incate_drank,crt_buy_cnt_incate_prank,
col_buy_cnt_incate_drank,col_buy_cnt_incate_prank,
bws_buy_cnt_incate_drank,bws_buy_cnt_incate_prank,
buy_cnt_incate_drank,buy_cnt_incate_prank,
pro1_beh_incate_drank,pro1_beh_incate_prank,
pro2_beh_incate_drank,pro2_beh_incate_prank,
beh_nobuy_drank,beh_nobuy_prank,
pro1_buy_times,pro1_crt_times,pro1_col_times,
pro3_buy_times,pro3_crt_times,pro3_col_times,pro3_bws_times,
pro7_buy_times,pro7_crt_times,pro7_col_times,pro7_bws_times,
pro11_buy_times,pro11_crt_times,pro11_col_times,pro11_bws_times,

pro1_buy_times_h,pro1_crt_times_h,pro1_col_times_h,pro1_bws_times_h,--------？？？-----
pro3_buy_times_h,pro3_crt_times_h,pro3_col_times_h,pro3_bws_times_h,
pro17_buy_times,pro17_crt_times,pro17_col_times,pro17_bws_times,

case when u_recent_2d_interact_days==-1 then -1
     else (u_recent_2d_buy_days+1)/(u_recent_2d_interact_days+1) 
end  as u_recent_2d_interact_buy_prob,
case when u_recent_3d_interact_days==-1 then -1
     else (u_recent_3d_buy_days+1)/(u_recent_3d_interact_days+1) 
end  as u_recent_3d_interact_buy_prob,

case when u_recent_4d_interact_days==-1 then -1
     else (u_recent_4d_buy_days+1)/(u_recent_4d_interact_days+1) 
end  as u_recent_4d_interact_buy_prob,


case when u_recent_5d_interact_days==-1 then -1
     else (u_recent_5d_buy_days+1)/(u_recent_5d_interact_days+1) 
end  as u_recent_5d_interact_buy_prob,

case when u_recent_7d_interact_days==-1 then -1
     else (u_recent_7d_buy_days+1)/(u_recent_7d_interact_days+1) 
end  as u_recent_7d_interact_buy_prob,

case when u_recent_15d_interact_days==-1 then -1
     else (u_recent_15d_buy_days+1)/(u_recent_15d_interact_days+1) 
end  as u_recent_15d_interact_buy_prob,
case when u_recent_26d_interact_days==-1 then -1
     else (u_recent_26d_buy_days+1)/(u_recent_26d_interact_days+1) 
end  as u_recent_26d_interact_buy_prob,

case when i_recent_2d_interact_days==-1 then -1
     else (i_recent_2d_buy_days+1)/(i_recent_2d_interact_days+1) 
end  as i_recent_2d_interact_buy_prob,
case when i_recent_3d_interact_days==-1 then -1
     else (i_recent_3d_buy_days+1)/(i_recent_3d_interact_days+1) 
end  as i_recent_3d_interact_buy_prob,

case when i_recent_4d_interact_days==-1 then -1
     else (i_recent_4d_buy_days+1)/(i_recent_4d_interact_days+1) 
end  as i_recent_4d_interact_buy_prob,

case when i_recent_5d_interact_days==-1 then -1
     else (i_recent_5d_buy_days+1)/(i_recent_5d_interact_days+1) 
end  as i_recent_5d_interact_buy_prob,

case when i_recent_7d_interact_days==-1 then -1
     else (i_recent_7d_buy_days+1)/(i_recent_7d_interact_days+1) 
end  as i_recent_7d_interact_buy_prob,

case when i_recent_15d_interact_days==-1 then -1
     else (i_recent_15d_buy_days+1)/(i_recent_15d_interact_days+1) 
end  as i_recent_15d_interact_buy_prob,
case when i_recent_26d_interact_days==-1 then -1
     else (i_recent_26d_buy_days+1)/(i_recent_26d_interact_days+1) 
end  as i_recent_26d_interact_buy_prob

from 19day_combine;

drop table if exists 19day_combine;
create table 19day_combine as 
select * from 19day_combine_backup_0531;
drop table if exists 18day_combine;
create table 18day_combine as 
select * from 18day_combine_backup_0531;
drop table if exists 17day_combine;
create table 17day_combine as 
select * from 17day_combine_backup_0531;